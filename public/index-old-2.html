<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />

	<link rel="stylesheet" href="css/jquery.mobile-1.4.4.min.css" />
    <link rel="stylesheet" href="css/ssOrange.min.css" />

	<script src="js/jquery-1.11.1.min.js"></script>
	<script src="js/jquery.mobile-1.4.4.min.js"></script>
    <script src="canv-gauge/gauge.min.js"></script>
    <script type="text/javascript" src="js/2.0.0-crypto-sha1.js"></script>
    <script type="text/javascript" src="js/2.0.0-hmac-min.js"></script>
    <script type="text/javascript" src="js/sha1.js"></script>
    <script type="text/javascript" src="js/hotp.js"></script>


	<title>Open Automation Center</title>

</head>

<body>

    <!-- homePage START -->
    <div data-role="page" id="home" data-theme="b" data-content-theme="b">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>Open Automation Center</h1>
        </div>
        <div id="roomsList" data-role="content">
            <ul data-role="listview" id="rooms-list" data-inset="true">
            </ul>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#toolsList" class="ui-btn ui-icon-grid ui-btn-icon-top">ToolBox</a>
                </ul>
            </div>
        </div>
    </div>
    <!-- homePage END -->

    <!-- roomPage0 START -->
    <div data-role="page" id="roomPage0" data-theme="b" data-content-theme="b">
        <div id="roomHeader0" data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1> </h1>
        </div>
        <div data-role="content">
            <canvas id="gauge0"></canvas>
        </div>
        <div data-role="footer" data-tap-toggle="false" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#home" class="ui-btn ui-icon-bullets ui-btn-icon-top">Home</a>
                    <li><a href="#roomPage1" id="control0" class="ui-btn ui-icon-carat-r ui-btn-icon-top">Next</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- roomPage0 END -->

    <!-- roomPage1 START -->
    <div data-role="page" id="roomPage1" data-theme="b" data-content-theme="b">
        <div id="roomHeader1" data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1> </h1>
        </div>
        <div data-role="content">
            <canvas id="gauge1"></canvas>
        </div>
        <div data-role="footer" data-tap-toggle="false" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#roomPage0" id="control-1" class="ui-btn ui-icon-carat-l ui-btn-icon-top">Prev</a></li>
                    <li><a href="#roomPage2" id="control1" class="ui-btn ui-icon-carat-r ui-btn-icon-top">Next</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- roomPage1 END -->

    <!-- roomPage2 START -->
    <div data-role="page" id="roomPage2" data-theme="b" data-content-theme="b">
        <div id="roomHeader2" data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1> </h1>
        </div>
        <div data-role="content">
            <canvas id="gauge2"></canvas>
        </div>
        <div data-role="footer" data-tap-toggle="false" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#roomPage1" id="control-2" class="ui-btn ui-icon-carat-l ui-btn-icon-top">Prev</a></li>
                    <li><a href="#appsList" id="control2" class="ui-btn ui-icon-power ui-btn-icon-top">Control</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- roomPage2 END -->

    <!-- toolsListPage START -->
    <div data-role="page" id="toolsList" data-theme="b" data-content-theme="b">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>ToolBox</h1>
        </div>
        <div data-role="content">
            <ul data-role="listview" data-inset="true">

                <li><a href="#set-up">
                    <img src="icons/PNG/64x64/distribute-horizontal-centers.png" />
                    Set-Up
                    <p>Control all Settings here</p></a>
                </li>

                <li><a href="#appsList">
                    <img src="icons/PNG/64x64/grid-2.png" />
                    Apps
                    <p>Installed Apps list</p></a>
                </li>

                <li><a href="#mainSensors">
                    <img src="icons/PNG/64x64/microphone.png" />
                    Check Sensors
                    <p>Check all Sensors at once</p></a>
                </li>

            </ul>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>
                </ul>
            </div>
        </div>
    </div>
    <!-- toolsListPage END -->


    <!-- set-UpPage START -->
    <div data-role="page" id="set-up" data-theme="b" data-content-theme="b">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>Set-Up</h1>
        </div>
        <div data-role="content">
            <ul data-role="listview" data-inset="true">

                <li><a href="#roomsSettings">
                    <img src="img/smartList.png" />
                    Rooms Set-Up
                    <p>Manage Rooms list</p></a>
                </li>

                <li><a href="#sensorsSettings">
                    <img src="img/smartList.png" />
                    Sensors Set-Up
                    <p>Manage Sensors</p></a>
                </li>

                <li><a href="#timersSettings">
                    <img src="img/smartList.png" />
                    Timers Set-Up
                    <p>Manage Timers</p></a>
                </li>

            </ul>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>
                </ul>
            </div>
        </div>
    </div>
    <!-- set-UpPage END -->












    <!-- appsPage START -->

    <div data-role="page" id="appsList" data-theme="b" data-content-theme="b">
		<div data-role="header" data-position="fixed" data-tap-toggle="false">
		    <h1>Smart apps</h1>
		</div>

        <div data-role="content">
            <ul data-role="listview" data-inset="true">

                <li><a href="#greenHouseApp">
                    <img src="img/smartListGH.png" />
                    Green House
                    <p>Control green house: temperature, humidity and light</p></a>
                </li>

                <li><a href="#co2FreeApp">
                    <img src="img/smartListCo22.png" />
                    CO2 Free
                    <p>Enable functions to control CO2 level in room</p></a>
                </li>

                <li><a href="#comfortZoneApp">
                    <img src="img/smartListCZ.png" />
                    Comfort Zone
                    <p>Enable functions to control temperature</p></a>
                </li>


            </ul>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#home" data-icon="home" data-role="button" data-theme="b" data-transition="fade">Home</a>
                    <li><a href="#mainSensors" data-icon="grid" data-role="button" data-theme="b" data-transition="fade">Sensors</a>

                </ul>
            </div>
        </div>

	</div>

    <!-- appsPage END -->



    <!-- mainSensors START -->

	<div data-role="page" id="mainSensors" data-theme="b" data-content-theme="b">
		<div data-role="header" data-position="fixed" data-tap-toggle="false">

		<h1 id="sensorsView"> Sensors View </h1>

		</div>
		<div data-role="content">

            <ul id="sensorsTable" data-role="listview" data-inset="true">

            </ul>

		</div>

		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>
				</ul>
			</div>
		</div>
	</div>

    <!-- mainSensors END -->




    <!-- co2FreeAppPage START -->

    <div data-role="page" id="co2FreeApp" data-cache="false" data-title="Comfort Zone Control" data-theme="b" data-content-theme="b">

        <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>CO2 Free</h1>

        </div>

        <div data-role="content">

            <div data-role="fieldcontainer">
                <label id="temperatureSetLabelCO2" >Temperature set</label>
                <input type="range" id="temperatureSetCO2" data-highlight="true" min="10" max="50" value="25">
            </div>

            <div data-role="fieldcontainer">
                <label id="co2LevelSetLabelCO2" >CO2 level set</label>
                <input type="range" id="co2LevelSetCO2" data-highlight="true" min="380" max="900" value="500">
            </div>


            <br />

            <div class="ui-grid-b">

                <div class="ui-block-a">
                    <label >Mode</label>
                    <input type="checkbox" id="modeSetSwCO2" data-on-text="Heat" data-off-text="Cool" data-role="flipswitch">
                </div>

                <div class="ui-block-b">
                    <label >Fan</label>
                    <input type="checkbox" id="fanSwCO2" data-role="flipswitch">
                </div>

                <div class="ui-block-c">
                    <label >Fan timer</label>
                    <input type="checkbox" id="fanTimerSwCO2" data-role="flipswitch">
                </div>
            </div>


            <div data-role="collapsible-set">

                <div data-role="collapsible" data-collapsed="true" data-theme="b">
                    <h4>Fan On timer set</h4>

                    <div class="ui-grid-a">

                        <div class="ui-block-a">
                            <label >Fan from:</label>
                            <input type="time" id="fanFromCO2"  placeholder="00:00">
                        </div>

                        <div class="ui-block-b">
                            <label >Fan to:</label>
                            <input type="time" id="fanToCO2"  placeholder="00:00">
                        </div>

                    </div>


                </div>
            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#home" data-icon="home" data-role="button" data-theme="b" data-transition="fade">Home</a>
                    <li><a href="#mainSensors" data-icon="grid" data-role="button" data-theme="b" data-transition="fade">Sensors</a>
                    <li><a href="#co2FreeSettings" data-icon="gear" data-role="button" data-theme="b" data-transition="fade">Settings</a>
                    <li><a href="#aboutCo2FreeApp" data-icon="info" data-role="button" data-theme="b" data-transition="fade">About</a>
                </ul>
            </div>
        </div>
    </div>

    <div data-role="page" id="co2FreeSettings" data-theme="b" data-content-theme="b">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">

            <h1>CO2 Free Settings</h1>

        </div>
        <div data-role="content">
            <div data-role="fieldcontainer">
                <label >Please enter your App ID:</label>
                <input type="text" id="appIDInputCO2" >
                <p>
                    <a id="demoAPICO2" href="#" data-role="button" data-inline="true" data-theme="b" >DEMO ID</a>
                    <a id="resetAPICO2" href="#" data-role="button" data-inline="true" data-theme="b" >Clear</a>
                </p>
            </div>

            <div data-role="fieldcontainer">
                <p>
                    <a id="checkCO2Command" href="#" data-role="button" data-inline="true" data-theme="b" >Check controller command</a>
                </p>
            </div>

            <p>For more information please visit
                <a class="ui-link" onclick='window.open("https://smartsensors.io/app/co2-free","_system", "location=yes")' href='javascript:void(0)' >https://smartsensors.io/app/co2-free</a>
            </p>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>
                </ul>
            </div>
        </div>

    </div>

    <div data-role="page" id="aboutCo2FreeApp" data-overlay-theme="b" data-theme="b" data-content-theme="b">
        <div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">

            <h1><img src="img/logo.png"></h1>
            <h3>CO2 Free v.1.0</h3>

        </div>
        <div data-role="content">
            <p>CO2 level control </p>
            <p>Open firmware for Arduino Ethernet</p>
            <p>Author: Vaidotas Gudaitis</p>
            <p>Designed by: <a class="ui-link" onclick='window.open("http://appconstructor.io","_system", "location=yes")' href='javascript:void(0)' > appconstructor.io </a></p>
            <p>For more information please visit
                <a class="ui-link" onclick='window.open("https://smartsensors.io/app/co2-free","_system", "location=yes")' href='javascript:void(0)' >https://smartsensors.io/app/co2-free</a>
            </p>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>

                </ul>
            </div>
        </div>

    </div>

    <!-- co2FreeAppPage END -->







    <!-- comfortZoneAppPage START -->

    <div data-role="page" id="comfortZoneApp" data-cache="false" data-title="Comfort Zone Control" data-theme="b" data-content-theme="b">

        <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>Comfort Zone</h1>

        </div>

        <div data-role="content">

            <div data-role="fieldcontainer">
                <label id="temperatureLabelCZ" >Temperature set</label>
                <input type="range" id="temperatureSetCZ" data-highlight="true" min="10" max="50" value="25">
            </div>

            <div data-role="fieldcontainer">
                <label id="fanSpeedLabelCZ" >Fan speed set</label>
                <input type="range" id="fanSpeedSetCZ" data-highlight="true" min="0" max="4" value="0">
            </div>


            <br />

            <div class="ui-grid-b">
                <div class="ui-block-a">
                    <label >Power</label>
                    <input type="checkbox" id="powerOnSwCZ" data-role="flipswitch">
                </div>

                <div class="ui-block-b">
                    <label >Mode</label>
                    <input type="checkbox" id="modeSetCZ" data-on-text="Heat" data-off-text="Cool" data-role="flipswitch">
                </div>

                <div class="ui-block-c">
                    <label >Off-hours</label>
                    <input type="checkbox" id="offlineHoursModeSetCZ" data-role="flipswitch">
                </div>

            </div>



            <div data-role="collapsible-set">

                <div data-role="collapsible" data-collapsed="true" data-theme="b">
                    <h4>Offline hours time set</h4>

                    <div class="ui-grid-a">
                        <div class="ui-block-a">

                            <div data-role="fieldcontainer">

                                <label for="offHBCZ" >Off-hours start</label>
                                <input type="time" id="offHBCZ"  placeholder="00:00">

                            </div>

                        </div>

                        <div class="ui-block-b">

                            <label for="offHECZ" >Off-hours end</label>
                            <input type="time" id="offHECZ"  placeholder="00:00">

                        </div>

                    </div>


                </div>
            </div>

        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#home" data-icon="home" data-role="button" data-theme="b" data-transition="fade">Home</a>
                    <li><a href="#mainSensors" data-icon="grid" data-role="button" data-theme="b" data-transition="fade">Sensors</a>
                    <li><a href="#comfortZoneSettings" data-icon="gear" data-role="button" data-theme="b" data-transition="fade">Settings</a>
                    <li><a href="#aboutComfortZoneApp" data-icon="info" data-role="button" data-theme="b" data-transition="fade">About</a>
                </ul>
            </div>
        </div>
    </div>

    <div data-role="page" id="comfortZoneSettings" data-theme="b" data-content-theme="b">
        <div data-role="header" data-position="fixed" data-tap-toggle="false">

            <h1>Comfort Zone Settings</h1>

        </div>
        <div data-role="content">
            <div data-role="fieldcontainer">
                <label >Please enter your App ID:</label>
                <input type="text" id="appIDInputCZ" >
                <p>
                    <a id="demoAPICZ" href="#" data-role="button" data-inline="true" data-theme="b" >DEMO ID</a>
                    <a id="resetAPICZ" href="#" data-role="button" data-inline="true" data-theme="b" >Clear</a>
                </p>
            </div>

            <div data-role="fieldcontainer">
                <p>
                    <a id="checkComfortZoneCommand" href="#" data-role="button" data-inline="true" data-theme="b" >Check controller command</a>
                </p>
            </div>

            <p>For more information please visit
                <a class="ui-link" onclick='window.open("https://smartsensors.io/app/temperature-control","_system", "location=yes")' href='javascript:void(0)' >https://smartsensors.io/app/temperature-control</a>
            </p>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>
                </ul>
            </div>
        </div>

    </div>

    <div data-role="page" id="aboutComfortZoneApp" data-overlay-theme="b" data-theme="b" data-content-theme="b">
        <div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">

            <h1><img src="img/logo.png"></h1>
            <h3>Comfort Zone v.1.0</h3>

        </div>
        <div data-role="content">
            <p>Temperatuere control application.</p>
            <p>Open firmware for Arduino Ethernet</p>
            <p>Author: Vaidotas Gudaitis</p>
            <p>Designed by: <a class="ui-link" onclick='window.open("http://appconstructor.io","_system", "location=yes")' href='javascript:void(0)' > appconstructor.io </a></p>
            <p>For more information please visit
                <a class="ui-link" onclick='window.open("https://smartsensors.io/app/temperature-control","_system", "location=yes")' href='javascript:void(0)' >https://smartsensors.io/app/temperature-control</a>
            </p>
        </div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>

                </ul>
            </div>
        </div>

    </div>

    <!-- comfortZoneAppPage END -->





    <!-- greenHouseAppPage START -->

    <div data-role="page" id="greenHouseApp" data-cache="false" data-title="Green House Control" data-theme="b" data-content-theme="b">

		<div data-role="header" data-position="fixed" data-tap-toggle="false">
			<h1>Green House Control</h1>

		</div>

		<div data-role="content">

			<div data-role="fieldcontainer">
				<label id="tSetLabel" for="temperatureSet">Temperature set</label>
				<input type="range" id="temperatureSet" name="temperatureSet" data-highlight="true" min="10" max="50" value="25">
			</div>

			<div data-role="fieldcontainer">
				<label id="hSetLabel" for="humiditySet">Humidity set</label>
				<input type="range" id="humiditySet" name="humiditySet" data-highlight="true" min="50" max="99" value="80">
			</div>

			<div data-role="fieldcontainer">
				<label id="wSetLabel" for="wateringDurationSet">Watering duration set</label>
				<input type="range" id="wateringDurationSet" name="wateringDurationSet" data-highlight="true" min="1" max="9" value="3">
			</div>

			<br />

			<div class="ui-grid-a">

				<div class="ui-block-a">
					<label for="lightOnSw">Light</label>
					<input type="checkbox" id="lightOnSw" data-role="flipswitch">
				</div>

				<div class="ui-block-b">
					<label for="fanOnSw">Fan</label>
					<input type="checkbox" id="fanOnSw" data-role="flipswitch">
				</div>
			</div>



			<div data-role="collapsible-set">
				<div data-role="collapsible" data-collapsed="true" data-theme="b">
					<h4>Humidity timers </h4>


                    <div class="ui-grid-a">
                        <div class="ui-block-a">

                            <div data-role="fieldcontainer">
                                <label for="wateringTimerSW">Turn ON timers</label>
                                <input type="checkbox" id="wateringTimerSW" data-role="flipswitch">
                            </div>

                        </div>

                        <div class="ui-block-b">
                            <a id="wTbutton1" href="#wateringTimerSet1" data-role="button" data-inline="true"  data-transition="pop">T1 00:00</a>
                            <a id="wTbutton2" href="#wateringTimerSet2" data-role="button" data-inline="true"  data-transition="pop">T2 00:00</a>
                            <a id="wTbutton3" href="#wateringTimerSet3" data-role="button" data-inline="true"  data-transition="pop">T3 00:00</a>
                            <a id="wTbutton4" href="#wateringTimerSet4" data-role="button" data-inline="true"  data-transition="pop">T4 00:00</a>
                            <a id="wTbutton5" href="#wateringTimerSet5" data-role="button" data-inline="true"  data-transition="pop">T5 00:00</a>


                        </div>

                    </div>

				</div>
				<div data-role="collapsible" data-collapsed="true" data-theme="b">
					<h4>Light timer</h4>

                    <div class="ui-grid-a">
                        <div class="ui-block-a">
                            <label for="lightTimerSW">Turn ON timer</label>
                            <div data-role="fieldcontainer">
                                <input type="checkbox" id="lightTimerSW" data-role="flipswitch">
                            </div>

                        </div>

                        <div class="ui-block-b">

                            <label for="lightOnTime" >Light On time</label>
                            <input type="time" id="lightOnTime" name="lightOnTime" placeholder="00:00">

                            <label for="lightOfftime" >Light Off time</label>
                            <input type="time" id="lightOffTime" name="lightOffTime" placeholder="00:00">

                        </div>

                    </div>


				</div>
			</div>

		</div>

		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href="#home" data-icon="home" data-role="button" data-theme="b" data-transition="fade">Home</a>
					<li><a href="#mainSensors" data-icon="grid" data-role="button" data-theme="b" data-transition="fade">Sensors</a>
					<li><a href="#greenHouseSettings" data-icon="gear" data-role="button" data-theme="b" data-transition="fade">Settings</a>
					<li><a href="#aboutGreenHouseApp" data-icon="info" data-role="button" data-theme="b" data-transition="fade">About</a>
				</ul>
			</div>
		</div>
	</div>

	<div data-role="page" id="greenHouseSettings" data-theme="b" data-content-theme="b">
		<div data-role="header" data-position="fixed" data-tap-toggle="false">

		<h1>Green House Settings</h1>

		</div>
		<div data-role="content">
			<div data-role="fieldcontainer">
				<label >Please enter your App ID:</label>
				<input type="text" id="appIDInput" >
                <p>
				<a id="demoAPI" href="#" data-role="button" data-inline="true" data-theme="b" >DEMO ID</a>
                <a id="resetAPI" href="#" data-role="button" data-inline="true" data-theme="b" >Clear</a>
                </p>
			</div>

            <div data-role="fieldcontainer">
                <p>
                    <a id="checkGreenHouseCommand" href="#" data-role="button" data-inline="true" data-theme="b" >Check controller command</a>
                </p>
            </div>

            <p>For more information please visit
                <a class="ui-link" onclick='window.open("https://smartsensors.io/app/warm-house","_system", "location=yes")' href='javascript:void(0)' >https://smartsensors.io/app/warm-house</a>
            </p>
		</div>


		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>		
				</ul>
			</div>
		</div>

	</div>

	<div data-role="page" id="aboutGreenHouseApp" data-overlay-theme="b" data-theme="b" data-content-theme="b">
		<div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">

			<h1><img src="img/logo.png"></h1>
			<h3>Green House v.1.2</h3>

		</div>
		<div data-role="content">
			<p>Green House control application.</p>
            <p>Open firmware for Arduino Ethernet</p>
			<p>Author: Vaidotas Gudaitis</p>
            <p>Designed by: <a class="ui-link" onclick='window.open("http://appconstructor.io","_system", "location=yes")' href='javascript:void(0)' > appconstructor.io </a></p>
            <p>For more information please visit
                <a class="ui-link" onclick='window.open("https://smartsensors.io/app/warm-house","_system", "location=yes")' href='javascript:void(0)' >https://smartsensors.io/app/warm-house</a>
            </p>
		</div>
        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" data-icon="back" data-role="button" data-rel="back" data-theme="b">Close</a>

                </ul>
            </div>
        </div>

	</div>

    <div data-role="page" id="wateringTimerSet1" data-dialog="true" data-overlay-theme="b" data-theme="b">
		<div data-role="header">
			<h1>Watering Timer 1</h1>
		</div>
		<div data-role="content">
			<div data-role="fieldcontainer" >
				<label for="wateringTimeSet1" >Enter watering time</label>
				<input type="time" id="wateringTimeSet1" name="wateringTimeSet1" placeholder="00:00">			
			</div>
		</div>
		<div data-role="footer" class="ui-bar">
			<a href="#" data-rel="back" >Close</a>
		</div>
	</div>
	<div data-role="page" id="wateringTimerSet2" data-dialog="true" data-overlay-theme="b" data-theme="b">
		<div data-role="header">
			<h1>Watering Timer 2</h1>
		</div>
		<div data-role="content">
			<div data-role="fieldcontainer" >
				<label for="wateringTimeSet2" >Enter watering time</label>
				<input type="time" id="wateringTimeSet2" name="wateringTimeSet2" placeholder="00:00">			
			</div>
		</div>
		<div data-role="footer" class="ui-bar">
			<a href="#" data-rel="back" >Close</a>
		</div>
	</div>
	<div data-role="page" id="wateringTimerSet3" data-dialog="true" data-overlay-theme="b" data-theme="b">
		<div data-role="header">
			<h1>Watering Timer 3</h1>
		</div>
		<div data-role="content">
			<div data-role="fieldcontainer" >
				<label for="wateringTimeSet3" >Enter watering time</label>
				<input type="time" id="wateringTimeSet3" name="wateringTimeSet3" placeholder="00:00">			
			</div>
		</div>
		<div data-role="footer" class="ui-bar">
			<a href="#" data-rel="back" >Close</a>
		</div>
	</div>
	<div data-role="page" id="wateringTimerSet4" data-dialog="true" data-overlay-theme="b" data-theme="b">
		<div data-role="header">
			<h1>Watering Timer 4</h1>
		</div>
		<div data-role="content">
			<div data-role="fieldcontainer" >
				<label for="wateringTimeSet4" data-overlay-theme="b" data-theme="b" >Enter watering time</label>
				<input type="time" id="wateringTimeSet4" name="wateringTimeSet4" placeholder="00:00">			
			</div>
		</div>
		<div data-role="footer" class="ui-bar">
			<a href="#" data-rel="back" >Close</a>
		</div>
	</div>
	<div data-role="page" id="wateringTimerSet5" data-dialog="true" data-overlay-theme="b" data-theme="b">
		<div data-role="header">
			<h1>Watering Timer 5</h1>
		</div>
		<div data-role="content">
			<div data-role="fieldcontainer" >
				<label for="wateringTimeSet5" >Enter watering time</label>
				<input type="time" id="wateringTimeSet5" name="wateringTimeSet5" placeholder="00:00">			
			</div>
		</div>
		<div data-role="footer" class="ui-bar">
			<a href="#" data-rel="back"  data-theme="b">Close</a>
		</div>
	</div>

    <!-- greenHouseAppPage END -->



<script type="text/javascript">


function showSensors(sensorType, sensorID){

    console.log('showSensors > sensorID: ' + sensorID + ' sensorType: ' + sensorType);

    for (var i = 0; i < sensorType.length; i++) {
            var activeSensor = sensorType[i];
            var activeSensorID = sensorID[i];
            var type = activeSensor.substring(0, 1);
            var renderTo = 'gauge' + i;

            if (type == 'T' ) showSensorT(renderTo, activeSensorID);
            if (type == 'H' ) showSensorH(renderTo, activeSensorID);
    }


    function showSensorT(renderTo, activeSensorID) {

            var gauge = new Gauge({

                renderTo: renderTo,
                title: 'Temperature',
                width: document.body.offsetWidth/1.1,
                height: document.body.offsetHeight/1.5,
                glow: true,
                units: '°C',
                minValue: -50,
                maxValue: 50,
                colors      : {
                    plate      : '#222',
                    //majorTicks : '#f5f5f5',
                    //minorTicks : '#ddd',
                    title      : '#fff',
                    units      : '#ccc',
                    numbers    : '#eee',
                    needle     : { start:'rgba(240, 128, 128, 1)', end :'rgba(255, 160, 122, .9)' }
                },
                    strokeTicks : false,
                    highlights : [
                {
                    from  : -50,
                    to    : 0,color : 'LightBlue'
                }, {
                    from  : 0,
                    to    : 25,color : 'PaleGreen'
                }, {
                    from  : 25,
                    to    : 40,color : 'Khaki'
                }, {
                    from  : 40,
                    to    : 50,color : 'LightSalmon'
                }],
                    animation : {
                    delay : 25,
                    duration: 600,
                    fn : 'elastic'
                }
        });

        drawCanvas(gauge, activeSensorID);
    }

    function showSensorH(renderTo, activeSensorID) {

        var gauge = new Gauge({

            renderTo: renderTo,
            title: 'Humidity',
            width: document.body.offsetWidth/1.1,
            height: document.body.offsetHeight/1.5,
            glow: true,
            units: '%',
            minValue: 0,
            maxValue: 100,

             majorTicks  : ['0','10','20','30','40','50','60','70','80','100'],
             minorTicks  : 2,
             strokeTicks : false,
             highlights  : [
             { from : 0, to : 40,   color : 'rgba(0, 0,  255, .25)' },
             { from : 40, to : 80,  color : 'rgba(255, 30,  0, .25)' }
             ],

            colors      : {
                plate      : '#222',
                majorTicks : '#f5f5f5',
                minorTicks : '#ddd',
                title      : '#fff',
                units      : '#ccc',
                numbers    : '#eee',
                needle     : { start:'rgba(240, 128, 128, 1)', end :'rgba(255, 160, 122, .9)' }
            },

            animation : {
                delay : 25,
                duration: 600,
                fn : 'elastic'
            }
        });

        drawCanvas(gauge, activeSensorID);
    }

}



function drawCanvas(gauge, sensorID){
    console.log('drawCanvas step1 > sensorID:' + sensorID );

    gauge.onready = function() {

        getOA('token','info', function(){

            gauge.setValue( oa.sensorsValue[sensorID] );
            console.log('drawCanvas step 2> sensorID:' + sensorID + ' Value:' + oa.sensorsValue[sensorID]);
        });
        /*
        setInterval( function() {
            getOA('info', function(){
                gauge.setValue( oa.sensorsValue[sensorID]);
            });
        }, 15000);
        */
    };

    gauge.draw();

    window.onresize= function() {
        gauge.updateConfig({
            width  : document.body.offsetWidth/1.1,
            height : document.body.offsetHeight/1.5
        });
    };
}




//$(document).ready(function(){
$(document).on('pagecreate', '#home', function() {

    oa = {};

    activeRoom = {
        id : null,
        label : null,
        sensors : [],
        allSensors : []
    };


    getOA('token', 'info', getRoomList);

    deviceReady();

    handleRoom();

});

function getOA(tokenLink, infoLink, cb){


    $.getJSON(tokenLink, function(oaToken) {
        if (oaToken) {

            var secret = 14037555258;
            var index = oaToken.token;
            var hotpID = hotp( secret, index, "dec6" );
            var sessionID = CryptoJS.SHA1(hotpID);
            var iLink = infoLink + '/' + sessionID;

            console.log('getOA > Get token:' + index + ' for session:' + hotpID);

            $.getJSON(iLink, function(oaConfig) {
                if (oaConfig) {
                    oa = oaConfig;
                    console.log(JSON.stringify(oa));
                    console.log('getOA > Config loaded successfully from ' + infoLink);

                    cb();


                } else {
                    console.log('getOA > ERROR: Config not loaded from ' + infoLink);
                }
            });


        } else {
            console.log('getOA > ERROR: Con\'t get token from ' + tokenLink);
        }
    });






}


function roomListConfig(){
    var liStr = '';
    for (var i = 0; i < oa.oa.rooms.length; i++) {

        liStr += '<li><a href="" data-id="' + i + '"> <img src="img/room.png" />' + oa.oa.rooms[i].label + '<p>Control ' + oa.oa.rooms[i].label + '</p></a></li>'
    }
    return liStr;
}



function getRoomList(){

    $('#rooms-list li').remove();
    $('#rooms-list').append(roomListConfig).listview('refresh');

    $(document).on('tap', '#rooms-list li a', function(){
        activeRoom.id = $(this).attr('data-id');
        activeRoom.label = oa.oa.rooms[activeRoom.id].label;
        activeRoom.sensors = oa.oa.rooms[activeRoom.id].sensors;
        activeRoom.allSensors = oa.oa.sensors;

        //alert('getRoomList > Room selected: ' + activeRoom.label + ' activeRoom: ' + JSON.stringify(activeRoom));

        $( "body" ).pagecontainer( "change", "#roomPage0", { transition: "fade", changeHash: false });
    });
}



function handleRoom(){



    $(document).on('pagebeforeshow', '#roomPage0', function(e, data) {

        console.log('Active Room: ' + activeRoom.label);
        $('#roomHeader0 h1').text(activeRoom.label);

        var sensorID = [], sensorType = [];

        for (var i = 0; i < activeRoom.sensors.length; i++) {
            for (var k = 0; k < activeRoom.allSensors.length; k++) {
                if(activeRoom.sensors[i] == activeRoom.allSensors[k]) {
                    sensorID.push(k);
                    sensorType.push(activeRoom.allSensors[k]);
                }
            }
        }

        var controlB0 = $('#control0');
        var controlB1 = $('#control1');

        if (activeRoom.sensors.length == 1) {

            controlB0.text('Control');
            controlB0.removeClass( 'ui-icon-carat-r');
            controlB0.addClass( ' ui-icon-power ');
            controlB0.prop("href", "#appsList");
        }

        if (activeRoom.sensors.length == 2) {
            controlB1.text('Control');
            controlB1.removeClass( 'ui-icon-carat-r');
            controlB1.addClass( ' ui-icon-power ');
            controlB1.prop("href", "#appsList");

            controlB0.text('Next');
            controlB0.removeClass( 'ui-icon-power');
            controlB0.addClass( 'ui-icon-carat-r');
            controlB0.prop("href", "#roomPage1");
        }

        if (activeRoom.sensors.length > 2) {
            controlB0.text('Next');
            controlB0.removeClass( 'ui-icon-power');
            controlB0.addClass( 'ui-icon-carat-r');
            controlB0.prop("href", "#roomPage1");

            controlB1.text('Next');
            controlB1.removeClass( 'ui-icon-power');
            controlB1.addClass( 'ui-icon-carat-r');
            controlB1.prop("href", "#roomPage2");
        }

        console.log('handleRoom > sensorID: ' + sensorID + ' sensorType: ' + sensorType);
        showSensors(sensorType, sensorID);
    });

    $(document).on('pagebeforeshow', '#roomPage1', function(e, data) {
        $('#roomHeader1 h1').text(activeRoom.label);
        if (activeRoom.sensors.length < 2) $('#room1B').hide();
        if (activeRoom.sensors.length > 1) {
            $('#room1B').show();
            $('room1S0').text(activeRoom.sensors[0]);
            $('room1S1').text(activeRoom.sensors[1]);
        }
        if (activeRoom.sensors.length > 2) $('room1S2').text(activeRoom.sensors[2]);

    });
    $(document).on('pagebeforeshow', '#roomPage2', function(e, data) {
        $('#roomHeader2 h1').text(activeRoom.label);
        if (activeRoom.sensors.length < 2) $('#room2B').hide();
        if (activeRoom.sensors.length > 1) {
            $('#room2B').show();
            $('room2S0').text(activeRoom.sensors[0]);
            $('room2S1').text(activeRoom.sensors[1]);
        }
        if (activeRoom.sensors.length > 2) $('room2S2').text(activeRoom.sensors[2]);

    });



}



function appNone(){

}


function appEnergyMeter(){

}


function appCO2Free(){

    $(document).on('pagebeforeshow', '#co2FreeApp', function(){

        if (window.localStorage.getItem('co2Free.setTemperature')) $("input#temperatureSetCO2").val(window.localStorage.getItem('co2Free.setTemperature')).slider("refresh");
        if (window.localStorage.getItem('co2Free.setCo2Level')) $("input#co2LevelSetCO2").val(window.localStorage.getItem('co2Free.setCo2Level')).slider("refresh");

        if (window.localStorage.getItem('co2Free.fanOn') == 'true')     $("input#fanSwCO2").prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('co2Free.setMode') == 'heating')     $("input#modeSetSwCO2").prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('co2Free.enableFanTimer') == 'true')   $("input#fanTimerSwCO2").prop("checked", true).flipswitch("refresh");

        if (window.localStorage.getItem('co2Free.fanFrom')) $('input#fanFromCO2').val(window.localStorage.getItem('co2Free.fanFrom'));
        if (window.localStorage.getItem('co2Free.fanTo')) $('input#fanToCO2').val(window.localStorage.getItem('co2Free.fanTo'));

    });

    $(document).on('pagebeforeshow', '#co2FreeSettings', function(){
        if (window.localStorage.getItem('co2Free.APPID')) $('#appIDInputCO2').val(window.localStorage.getItem('co2Free.APPID'));
    });

    $(document).on( "tap", "#checkCO2Command", function() {

        function emptyCallback(){}

        var appID = window.localStorage.getItem('co2Free.APPID') || 'noApiKey';
        var url = 'http://smartsensors.io:8888/?cid=' + appID;


        $.ajax({
            type: 'GET',
            url: url,
            dataType: 'text',
            crossDomain: true,
            //contentType: "application/json",
            success: function(res) {

                if (res == "App-ID-Error") {
                    toast.showShort(" Incorrect CO2 Free App ID! \n Check App ID entered or use Demo ID");

                } else {

                    navigator.notification.alert(
                            res,
                            emptyCallback,
                            'Controller command:',
                            'OK'
                    );
                }

            },
            error: function (xhr, ajaxOptions, thrownError) {

                toast.showShort("Network error ");
                toast.showShort(xhr.status);
                toast.showShort(thrownError);

            }
        });

    });

    $( document ).on( "tap", '#demoAPICO2', function() {
        var CID = 'aae38ef13018afcc38';
        $("#appIDInputCO2").val(CID);
        window.localStorage.setItem('co2Free.APPID', CID);
    });

    $( document ).on( "tap", '#resetAPICO2', function() {
        var CID = '';
        $("#appIDInputCO2").val(CID);
    });

    $(document).on('pagecreate', function () {


        function appCommandPost(postData) {
            $.ajax({
                type: "POST",
                async: true,
                url: 'https://smartsensors.io/appCO2Free',
                data: postData,
                success: function (response) {
                    var answer = JSON.parse(response);

                    if (answer.status == 'welcome') {

                        //alert('App settings accepted by server!');

                    } else if (answer.status == 'noApiKey') {

                        toast.showShort(" Please set correct APP ID in settings tab first!");

                    } else {

                        toast.showShort(" Incorrect CO2 Free App ID! \n Please set correct APP ID in Settings tab.");

                    }
                }
            });
        }

        function buildCommandCo2Free() {

            var CID = window.localStorage.getItem('co2Free.APPID') || 'noApiKey';
            var tSet = $("input#temperatureSetCO2").val() || '23';
            var cSet = $("input#co2LevelSetCO2").val() || '400';
            var fanFrom = $("#fanFromCO2").val() || '00:00';
            var fanTo = $("#fanToCO2").val() || '00:00';
            var virtualRoomID = '0';

            if (fanFrom.length < 5) fanFrom = '0' + fanFrom;
            if (fanTo.length < 5) fanTo = '0' + fanTo;
            if (tSet.length < 2) tSet = '0' + tSet;

            var command = '';
            command = 'F';
            command += virtualRoomID + ':';
            command += 'T=' + tSet + '.00';
            command += 'C=' + cSet;

            if ($("input#fanSwCO2").is(":checked")) {
                command += 'R=1';
            } else {

                if ($('input#fanTimerSwCO2').is(':checked')) {
                    command += 'R=T';
                } else {
                    command += 'R=0';
                }

            }

            command += 'R=' + fanFrom + fanTo;

            if ($('input#modeSetSwCO2').is(':checked')) {
                command += 'M=H';
            } else {
                command += 'M=C';
            }

            //alert('Command: ' + command);

            var commandToPost = {decision: 'setCommand', virtualRoomID: virtualRoomID, CID: CID, command: command, CommandCount: 1};
            appCommandPost(commandToPost);
        }

        function appSave(postData) {

            var key = 'co2Free.';
            var value = '';

            if (postData.decision === 'setTemperature') {
                key +=  postData.decision;
                value = postData.temperature;
                window.localStorage.setItem(key, value);
                buildCommandCo2Free();
            }

            if (postData.decision === 'setCo2Level') {
                key +=  postData.decision;
                value = postData.co2Level;
                window.localStorage.setItem(key, value);
                buildCommandCo2Free();
            }

            if (postData.decision === 'fanOn') {
                key +=  postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                buildCommandCo2Free();
            }

            if (postData.decision === 'setMode') {
                key += postData.decision;
                value = postData.mode;
                window.localStorage.setItem(key, value);
                buildCommandCo2Free();
            }

            if (postData.decision === 'enableFanTimer') {
                key += postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                buildCommandCo2Free();
            }

        }


        $("input#temperatureSetCO2").change(function () {
            var tVal = $(this).val();
            $('label#temperatureSetLabelCO2').text('Temperature set to ' + tVal + ' °C');
            var postData = {decision: 'setTemperature', temperature: tVal};
            appSave(postData);
        });

        $("input#co2LevelSetCO2").change(function () {
            var cVal = $(this).val();
            $('label#co2LevelSetLabelCO2').text('CO2 level set to ' + cVal + ' ppm');
            var postData = {decision: 'setCo2Level', co2Level: cVal};
            appSave(postData);
        });

        $("input#fanSwCO2").on("change", function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'fanOn', SW: true};
                appSave(postData);
            } else {
                postData = {decision: 'fanOn', SW: false};
                appSave(postData);
            }
        });

        $("input#modeSetSwCO2").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'setMode', mode: 'heating'};
                appSave(postData);
            } else {
                postData = {decision: 'setMode', mode: 'cooling'};
                appSave(postData);
            }
        });

        $("input#fanTimerSwCO2").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'enableFanTimer', SW: true};
                appSave(postData);
            } else {
                postData = {decision: 'enableFanTimer', SW: false};
                appSave(postData);
            }
        });

        $("input#fanFromCO2").bind("change", function (event, ui) {
            window.localStorage.setItem('co2Free.fanFrom', $("input#fanFromCO2").val());
            buildCommandCo2Free();
        });

        $("input#fanToCO2").bind("change", function (event, ui) {
            window.localStorage.setItem('co2Free.fanTo', $("input#fanToCO2").val());
            buildCommandCo2Free();
        });

        $("input#appIDInputCO2").bind("change", function (event, ui) {
            window.localStorage.setItem('co2Free.APPID', $("input#appIDInputCO2").val());
        });



    });

}


function appComfortZone(){

    $(document).on('pagebeforeshow', '#comfortZoneApp', function(){

        if (window.localStorage.getItem('comfortZone.setTemperature')) $("input#temperatureSetCZ").val(window.localStorage.getItem('comfortZone.setTemperature')).slider("refresh");
        if (window.localStorage.getItem('comfortZone.setFanSpeed')) $("input#fanSpeedSetCZ").val(window.localStorage.getItem('comfortZone.setFanSpeed')).slider("refresh");

        if (window.localStorage.getItem('comfortZone.powerOn') == 'true')     $("input#powerOnSwCZ").prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('comfortZone.setMode') == 'heating')     $("input#modeSetCZ").prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('comfortZone.enableOffHours') == 'true')   $("input#offlineHoursModeSetCZ").prop("checked", true).flipswitch("refresh");

        if (window.localStorage.getItem('comfortZone.offHB')) $('input#offHBCZ').val(window.localStorage.getItem('comfortZone.offHB'));
        if (window.localStorage.getItem('comfortZone.offHE')) $('input#offHECZ').val(window.localStorage.getItem('comfortZone.offHE'));

    });

    $(document).on('pagebeforeshow', '#comfortZoneSettings', function(){
        if (window.localStorage.getItem('comfortZone.APPID')) $('#appIDInputCZ').val(window.localStorage.getItem('comfortZone.APPID'));
    });

    $( document ).on( "tap", '#checkComfortZoneCommand', function() {

        function emptyCallback() {}

        var appID = window.localStorage.getItem('comfortZone.APPID') || 'noApiKey';
        var url = 'http://smartsensors.io:8888/?cid=' + appID;


        $.ajax({
            type: 'GET',
            url: url,
            dataType: 'text',
            crossDomain: true,
            //contentType: "application/json",
            success: function(res) {

                if (res == "App-ID-Error") {
                    toast.showShort(" Incorrect Comfort Zone App ID! \n Check App ID entered or use Demo ID");
                } else {

                    navigator.notification.alert(
                            res,
                            emptyCallback,
                            'Controller command:',
                            'OK'
                    );
                }

            },
            error: function (xhr, ajaxOptions, thrownError) {

                toast.showShort("Network error ");
                toast.showShort(xhr.status);
                toast.showShort(thrownError);

            }
        });

    });

    $( document ).on( "tap", '#demoAPICZ', function() {
        var CID =   'b674d96d63b7ae5efb';
        $("#appIDInputCZ").val(CID);
        window.localStorage.setItem('comfortZone.APPID', CID);
    });

    $( document ).on( "tap", '#resetAPICZ', function() {
        var CID =   '';
        $("#appIDInputCZ").val(CID);
    });

    $(document).on('pagecreate', function () {

        function appCommandPost(postData) {
            $.ajax({
                type: "POST",
                async: true,
                url: 'https://smartsensors.io/appFanCoil',
                data: postData,
                success: function (response) {
                    var answer = JSON.parse(response);

                    if (answer.status == 'welcome') {

                        //alert('App settings accepted by server!');

                    } else if (answer.status == 'noApiKey') {

                        toast.showShort(" Please set correct APP ID in settings tab first!");

                    } else {

                        toast.showShort(" Incorrect Comfort Zone App ID! \n Please set correct APP ID in Settings tab.");

                    }
                }
            });
        }

        function buildCommandComfortZone() {

            var CID = window.localStorage.getItem('comfortZone.APPID') || 'noApiKey';
            var tSet = $("#temperatureSetCZ").val() || '23';
            var fSet = $("#fanSpeedSetCZ").val() || '4';

            var offFrom = $("#offHBCZ").val() || '00:00';
            var offTo = $("#offHECZ").val() || '00:00';

            var virtualRoomID = '0';

            if (offFrom.length < 5) offFrom = '0' + offFrom;
            if (offTo.length < 5) offTo = '0' + offTo;
            if (tSet.length < 2) tSet = '0' + tSet;


            var command = '';
            command = 'F';
            command += virtualRoomID + ':';
            command += 'R=' + fSet;
            command += 'T=' + tSet + '.00';

            if ($('input#powerOnSwCZ').is(':checked')) {
                command += 'S=1';
            } else {
                command += 'S=0';
            }

            if ($('input#modeSetCZ').is(':checked')) {
                command += 'M=H';
            } else {
                command += 'M=C';
            }


            if ($('input#offlineHoursModeSetCZ').is(':checked')) {
                command += 'A=0';

            } else {
                command += 'A=1';
            }

            command += 'O=' + offFrom + offTo;

            //alert('Command: ' + command);

            var commandToPost = {decision: 'setCommand', virtualRoomID: virtualRoomID, CID: CID, command: command, CommandCount: 1};
            appCommandPost(commandToPost);

        }

        function appSave(postData) {

            var key = 'comfortZone.';
            var value = '';

            if (postData.decision === 'setTemperature') {
                key +=  postData.decision;
                value = postData.temperature;
                window.localStorage.setItem(key, value);
                buildCommandComfortZone();
                //alert ('Saved ' + postData.decision + ' ' + value);
            }

            if (postData.decision === 'setFanSpeed') {
                key +=  postData.decision;
                value = postData.fanSpeed;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandComfortZone();
            }

            if (postData.decision === 'powerOn') {
                key +=  postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandComfortZone();
            }

            if (postData.decision === 'setMode') {
                key += postData.decision;
                value = postData.mode;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandComfortZone();
            }

            if (postData.decision === 'enableOffHours') {
                key += postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandComfortZone();
            }

        }


        $("input#temperatureSetCZ").change(function () {
            var tVal = $(this).val();
            $('label#temperatureLabelCZ').text('Temperature set to ' + tVal + ' °C');
            var postData = {decision: 'setTemperature', temperature: tVal};
            appSave(postData);
        });

        $("input#fanSpeedSetCZ").change(function () {
            var fVal = $(this).val();

            if (fVal == 4) {
                $('label#fanSpeedLabelCZ').text('Fan speed - Auto ');
            } else {
                $('label#fanSpeedLabelCZ').text('Fan speed set to ' + fVal);
            }
            var postData = {decision: 'setFanSpeed', fanSpeed: fVal};
            appSave(postData);
        });

        $("input#powerOnSwCZ").on("change", function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'powerOn', SW: true};
                appSave(postData);
            } else {
                postData = {decision: 'powerOn', SW: false};
                appSave(postData);
            }
        });

        $("input#modeSetCZ").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'setMode', mode: 'heating'};
                appSave(postData);
            } else {
                postData = {decision: 'setMode', mode: 'cooling'};
                appSave(postData);
            }
        });

        $("input#offlineHoursModeSetCZ").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'enableOffHours', SW: true};
                appSave(postData);
            } else {
                postData = {decision: 'enableOffHours', SW: false};
                appSave(postData);
            }
        });


        $("input#offHBCZ").bind("change", function (event, ui) {
            window.localStorage.setItem('comfortZone.offHB', $("input#offHBCZ").val());
            buildCommandComfortZone();
        });

        $("input#offHECZ").bind("change", function (event, ui) {
            window.localStorage.setItem('comfortZone.offHE', $("input#offHECZ").val());
            buildCommandComfortZone();
        });


        $("input#appIDInputCZ").bind("change", function (event, ui) {
            window.localStorage.setItem('comfortZone.APPID', $("input#appIDInputCZ").val());
        });



    });

}


function appGreenHouse() {

    $(document).on('pagebeforeshow', '#greenHouseApp', function(){


        //alert($("#temperatureSet").val());
        //var SliderValue = $('#temperatureSet').attr('value');
        //alert(SliderValue);

        if (window.localStorage.getItem('greenHouse.wateringTimeSet1')) $('#wTbutton1').text("T1 " + window.localStorage.getItem('greenHouse.wateringTimeSet1'));
        if (window.localStorage.getItem('greenHouse.wateringTimeSet2')) $('#wTbutton2').text("T2 " + window.localStorage.getItem('greenHouse.wateringTimeSet2'));
        if (window.localStorage.getItem('greenHouse.wateringTimeSet3')) $('#wTbutton3').text("T3 " + window.localStorage.getItem('greenHouse.wateringTimeSet3'));
        if (window.localStorage.getItem('greenHouse.wateringTimeSet4')) $('#wTbutton4').text("T4 " + window.localStorage.getItem('greenHouse.wateringTimeSet4'));
        if (window.localStorage.getItem('greenHouse.wateringTimeSet5')) $('#wTbutton5').text("T5 " + window.localStorage.getItem('greenHouse.wateringTimeSet5'));


        if (window.localStorage.getItem('greenHouse.lightFrom')) $('input#lightOnTime').val(window.localStorage.getItem('greenHouse.lightFrom'));
        if (window.localStorage.getItem('greenHouse.lightTo')) $('input#lightOffTime').val(window.localStorage.getItem('greenHouse.lightTo'));
        if (window.localStorage.getItem('greenHouse.setTemperature')) $("input#temperatureSet").val(window.localStorage.getItem('greenHouse.setTemperature')).slider("refresh");
        if (window.localStorage.getItem('greenHouse.setHumidity')) $("input#humiditySet").val(window.localStorage.getItem('greenHouse.setHumidity')).slider("refresh");
        if (window.localStorage.getItem('greenHouse.setWateringDuration')) $("input#wateringDurationSet").val(window.localStorage.getItem('greenHouse.setWateringDuration')).slider("refresh");

        if (window.localStorage.getItem('greenHouse.lightEnable') == 'true')   $('input#lightOnSw').prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('greenHouse.fanEnable') == 'true')     $('input#fanOnSw').prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('greenHouse.enableOnHours') == 'true') $('input#wateringTimerSW').prop("checked", true).flipswitch("refresh");
        if (window.localStorage.getItem('greenHouse.lightTimer') == 'true')    $('input#lightTimerSW').prop("checked", true).flipswitch("refresh");


        //$('#powerOnSw').prop('checked', true).flipswitch("refresh").flipswitch("disable");
        //$('#powerOnSw').parent().addClass(' .ui-flipswitch-active');

    });

    $(document).on('pagebeforeshow', '#wateringTimerSet1', function(){ $('#wateringTimeSet1').val(window.localStorage.getItem('greenHouse.wateringTimeSet1')); });
    $(document).on('pagebeforeshow', '#wateringTimerSet2', function(){ $('#wateringTimeSet2').val(window.localStorage.getItem('greenHouse.wateringTimeSet2')); });
    $(document).on('pagebeforeshow', '#wateringTimerSet3', function(){ $('#wateringTimeSet3').val(window.localStorage.getItem('greenHouse.wateringTimeSet3')); });
    $(document).on('pagebeforeshow', '#wateringTimerSet4', function(){ $('#wateringTimeSet4').val(window.localStorage.getItem('greenHouse.wateringTimeSet4')); });
    $(document).on('pagebeforeshow', '#wateringTimerSet5', function(){ $('#wateringTimeSet5').val(window.localStorage.getItem('greenHouse.wateringTimeSet5')); });


    $(document).on('pagehide', '#wateringTimerSet1', function(){
        $('#wTbutton1').text("T1 " + window.localStorage.getItem('greenHouse.wateringTimeSet1'));
    });
    $(document).on('pagehide', '#wateringTimerSet2', function(){
        $('#wTbutton2').text("T2 " + window.localStorage.getItem('greenHouse.wateringTimeSet2'));
    });
    $(document).on('pagehide', '#wateringTimerSet1', function(){
        $('#wTbutton3').text("T3 " + window.localStorage.getItem('greenHouse.wateringTimeSet3'));
    });
    $(document).on('pagehide', '#wateringTimerSet1', function(){
        $('#wTbutton4').text("T4 " + window.localStorage.getItem('greenHouse.wateringTimeSet4'));
    });
    $(document).on('pagehide', '#wateringTimerSet1', function(){
        $('#wTbutton5').text("T5 " + window.localStorage.getItem('greenHouse.wateringTimeSet5'));
    });

    $(document).on('pagebeforeshow', '#greenHouseSettings', function(){
        //if (window.localStorage.getItem('greenHouse.APIKEY')) $('#apiKeyInput').val(window.localStorage.getItem('greenHouse.APIKEY'));
        if (window.localStorage.getItem('greenHouse.APPID')) $('#appIDInput').val(window.localStorage.getItem('greenHouse.APPID'));
    });

    $( document ).on( "tap", '#checkGreenHouseCommand', function() {

        function emptyCallback() {}

        var appID = window.localStorage.getItem('greenHouse.APPID') || 'noApiKey';
        var url = 'http://smartsensors.io:8888/?cid=' + appID;

        //alert('connecting to '+url);

        $.ajax({
            type: 'GET',
            url: url,
            dataType: 'text',
            crossDomain: true,
            //contentType: "application/json",
            success: function(res) {

                if (res == "App-ID-Error") {
                    toast.showShort(" Incorrect Green House App ID! \n Check App ID entered or use Demo ID");
                } else {

                    navigator.notification.alert(
                            res,
                            emptyCallback,
                            'Controller command:',
                            'OK'
                    );
                }

            },
            error: function (xhr, ajaxOptions, thrownError) {

                toast.showShort("Network error ");
                toast.showShort(xhr.status);
                toast.showShort(thrownError);

            }
        });

    });

    $( document ).on( "tap", '#demoAPI', function() {
        var CID =   '29f52919691faf8abb';
        //var apiKEY = '';
        //$("#apiKeyInput").val(apiKEY);
        $("#appIDInput").val(CID);
        window.localStorage.setItem('greenHouse.APPID', CID);
        //window.localStorage.setItem('greenHouse.APIKEY', apiKEY);
    });

    $( document ).on( "tap", '#resetAPI', function() {
        var CID =   '';
        //var apiKEY = '';
        //$("#apiKeyInput").val(apiKEY);
        $("#appIDInput").val(CID);
    });

    $(document).on('pagecreate', function () {


        function appCommandPost(postData) {
            $.ajax({
                type: "POST",
                async: true,
                url: 'https://smartsensors.io/appGreenHouse',
                data: postData,
                success: function (response) {
                    var answer = JSON.parse(response);

                    if (answer.status == 'welcome') {

                        //alert('App settings accepted by server!');
                        //console.log('App settings accepted by server!');

                    } else if (answer.status == 'noApiKey') {

                        //alert('Please set API Key first!');

                        toast.showShort(" Please set correct APP ID in settings tab first!");


                    } else {

                        //alert('App settings not accepted by server!');

                        toast.showShort(" Incorrect Green House App ID! \n Please set correct APP ID in Settings tab.");

                    }
                }
            });
        }

        function buildCommandGreenHouse() {

            var CID = window.localStorage.getItem('greenHouse.APPID') || 'noApiKey';
            var tSet = $("input#temperatureSet").val() || '00';
            var hSet = $("input#humiditySet").val() || '00';

            var lFrom = $("input#lightOnTime").val() || '00:00';
            var lTo = $("input#lightOffTime").val() || '00:00';

            var virtualRoomID = '0';
            var timerCount = '5';

            var t1Val = window.localStorage.getItem('greenHouse.wateringTimeSet1') || '00:00';
            var t2Val = window.localStorage.getItem('greenHouse.wateringTimeSet2') || '00:00';
            var t3Val = window.localStorage.getItem('greenHouse.wateringTimeSet3') || '00:00';
            var t4Val = window.localStorage.getItem('greenHouse.wateringTimeSet4') || '00:00';
            var t5Val = window.localStorage.getItem('greenHouse.wateringTimeSet5') || '00:00';


            if (lFrom.length < 5) lFrom = '0' + lFrom;
            if (lTo.length < 5) lTo = '0' + lTo;
            if (tSet.length < 2) tSet = '0' + tSet;
            if (hSet.length < 2) hSet = '0' + hSet;

            var command = '';
            command = 'F';
            command += virtualRoomID + ':';
            command += 'T=' + tSet + '.00';
            command += 'H=' + hSet;


            if ($("#lightOnSw").is(":checked")) {
                command += 'L=1';

            } else {

                if ($('#lightTimerSW').is(':checked')) {
                    command += 'L=T';
                } else {
                    command += 'L=0';
                }

            }

            if ($('input#wateringTimerSW').is(':checked')) {
                command += 'A=0';

            } else {
                command += 'A=1';
            }

            if ($('input#fanOnSw').is(':checked')) {
                command += 'R=1';
            } else {
                command += 'R=0';
            }

            command += 'L=' + lFrom + lTo;

            var timerSeconds = $('input#wateringDurationSet').val();

            command += 'I=B' + timerCount + '0' + timerSeconds + 't';

            command += t1Val + t2Val + t3Val + t4Val + t5Val;

            //alert('Command: ' + command);
            //window.localStorage.setItem('greenHouse.Command', command);
            //$('#greenHouseOutput').html('a' + command);

            var commandToPost = {decision: 'setCommand', virtualRoomID: virtualRoomID, CID: CID, command: command, CommandCount: 1};
            appCommandPost(commandToPost);

        }

        function appSave(postData) {

            var key = '';
            var value = '';

            if (postData.decision === 'setTemperature') {
                key = 'greenHouse.' + postData.decision;
                value = postData.temperature;
                window.localStorage.setItem(key, value);
                buildCommandGreenHouse();
                //alert ('Saved ' + postData.decision + ' ' + value);
            }

            if (postData.decision === 'setHumidity') {
                key = 'greenHouse.' + postData.decision;
                value = postData.humidity;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandGreenHouse();
            }

            if (postData.decision === 'lightEnable') {
                key = 'greenHouse.' + postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandGreenHouse();

            }

            if (postData.decision === 'fanEnable') {
                key = 'greenHouse.' + postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandGreenHouse();
            }

            if (postData.decision === 'lightTimer') {
                key = 'greenHouse.' + postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandGreenHouse();
            }

            if (postData.decision === 'lightFrom') {
                key = 'greenHouse.' + postData.decision;
                value = postData.lightFrom;
                window.localStorage.setItem(key, value);
                buildCommandGreenHouse();
            }

            if (postData.decision === 'lightTo') {
                key = 'greenHouse.' + postData.decision;
                value = postData.lightTo;
                window.localStorage.setItem(key, value);
                buildCommandGreenHouse();
            }

            if (postData.decision === 'enableOnHours') {
                key = 'greenHouse.' + postData.decision;
                value = postData.SW;
                window.localStorage.setItem(key, value);
                //alert ('Saved ' + postData.decision + ' ' + value);
                buildCommandGreenHouse();
            }

            if (postData.decision === 'setWateringDuration') {
                key = 'greenHouse.' + postData.decision;
                value = postData.duration;
                window.localStorage.setItem(key, value);
                buildCommandGreenHouse();
            }


        }

        $("#temperatureSet").change(function () {
            var tVal = $(this).val();
            $('#tSetLabel').text('Temperature set to ' + tVal  + ' °C');
            var postData = {decision: 'setTemperature', CID: 'appSave', virtualRoomID: '0', temperature: tVal, timerCount: 5};
            appSave(postData);
        });

        $("#humiditySet").change(function () {
            var hVal = $(this).val();
            $('#hSetLabel').text('Humidity set to ' + hVal + ' %');
            var postData = {decision: 'setHumidity', CID: 'appSave', virtualRoomID: '0', humidity: hVal, timerCount: 5};
            appSave(postData);
        });

        $("#wateringDurationSet").change(function () {
            var wVal = $(this).val();
            $('#wSetLabel').text('Watering duration set to ' + wVal + ' s');
            var postData = {decision: 'setWateringDuration', CID: 'appSave', virtualRoomID: '0', duration: wVal, timerCount: 5};
            appSave(postData);
        });

        $("#lightOnSw").on("change", function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'lightEnable', CID: 'appSave', virtualRoomID: '0', SW: true, timerCount: 5};
                appSave(postData);
            } else {
                postData = {decision: 'lightEnable', CID: 'appSave', virtualRoomID: '0', SW: false, timerCount: 5};
                appSave(postData);
            }


        });

        $("#fanOnSw").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'fanEnable', CID: 'appSave', virtualRoomID: '0', SW: true, timerCount: 5};
                appSave(postData);
            } else {
                postData = {decision: 'fanEnable', CID: 'appSave', virtualRoomID: '0', SW: false, timerCount: 5};
                appSave(postData);
            }
        });

        $("#wateringTimerSW").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'enableOnHours', CID: 'appSave', virtualRoomID: '0', SW: true, timerCount: 5};
                appSave(postData);
            } else {
                postData = {decision: 'enableOnHours', CID: 'appSave', virtualRoomID: '0', SW: false, timerCount: 5};
                appSave(postData);
            }
        });

        $("#lightTimerSW").change(function () {
            var postData = {};
            if ($(this).is(":checked")) {
                postData = {decision: 'lightTimer', CID: 'appSave', virtualRoomID: '0', SW: true, timerCount: 5};
                appSave(postData);
            } else {
                postData = {decision: 'lightTimer', CID: 'appSave', virtualRoomID: '0', SW: false, timerCount: 5};
                appSave(postData);
            }
        });


        $("#wateringTimeSet1").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.wateringTimeSet1', $("#wateringTimeSet1").val());
            buildCommandGreenHouse();
        });
        $("#wateringTimeSet2").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.wateringTimeSet2', $("#wateringTimeSet2").val());
            buildCommandGreenHouse();
        });
        $("#wateringTimeSet3").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.wateringTimeSet3', $("#wateringTimeSet3").val());
            buildCommandGreenHouse();
        });
        $("#wateringTimeSet4").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.wateringTimeSet4', $("#wateringTimeSet4").val());
            buildCommandGreenHouse();
        });
        $("#wateringTimeSet5").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.wateringTimeSet5', $("#wateringTimeSet5").val());
            buildCommandGreenHouse();
        });


        $("#lightOnTime").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.lightFrom', $("#lightOnTime").val());
            buildCommandGreenHouse();
        });
        $("#lightOffTime").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.lightTo', $("#lightOffTime").val());
            buildCommandGreenHouse();
        });


        //$("#apiKeyInput").bind("change", function (event, ui) {
        //    window.localStorage.setItem('greenHouse.APIKEY', $("#apiKeyInput").val());
        //});

        $("#appIDInput").bind("change", function (event, ui) {
            window.localStorage.setItem('greenHouse.APPID', $("#appIDInput").val());
        });

    });

}


function handleSensors() {

    $(document).on('pagebeforecreate', '#mainSensors', function(){
        var interval = setInterval(function(){
            $.mobile.loading('show');
            clearInterval(interval);
        },100);
    });

    $(document).on('pageshow', '#mainSensors', function(){
        var interval = setInterval(function(){
            $.mobile.loading('hide');
            clearInterval(interval);
        },100);
    });

    $(document).on('pagebeforeshow', '#mainSensors', function(e, data){

        var activeApp = data.prevPage.attr('id');
        var virtualRoomID = '0';
        var appID = '';
        var sensorsLabel = 'Sensors View';

        if(activeApp == 'greenHouseApp') {
            appID = window.localStorage.getItem('greenHouse.APPID') || 'noApiKey';
            sensorsLabel = 'Green House sensors';
        }
        if(activeApp == 'comfortZoneApp') {
            appID = window.localStorage.getItem('comfortZone.APPID') || 'noApiKey';
            sensorsLabel = 'Comfort Zone sensors';
        }
        if(activeApp == 'co2FreeApp') {
            appID = window.localStorage.getItem('co2Free.APPID') || 'noApiKey';
            sensorsLabel = 'CO2 Free sensors';
        }

        $('h1#sensorsView').html(sensorsLabel);

        //alert(activeApp + ' ' + appID);

        var infoSensorLink = 'https://smartsensors.io/info-sensor/' + appID + '/' + virtualRoomID;

        $.getJSON(infoSensorLink, function(sensorsList) {

            var sensorCount = sensorsList.sensorCount;
            var allSensorsShow = sensorsList.allSensorsShow;
            var tableConstruction = '';

            if (sensorCount > 0){


                for( var i = 0, lenSensorCount = sensorCount; i < lenSensorCount; i++ ) {

                    var sensorRoom = sensorsList.sensorRoom[i];
                    var sensorType = sensorsList.sensorType[i];
                    var sensorLabel = sensorsList.sensorLabel[i];
                    var sensorID = sensorsList.sensorID[i];
                    var sensorValue = sensorsList.sensorValue[i];
                    var sensorUnits = sensorsList.sensorUnits[i];
                    var sensorMinimumValue = sensorsList.sensorMinimumValue[i];
                    var sensorMaximumValue = sensorsList.sensorMaximumValue[i];
                    var sensorTime = sensorsList.sensorTime[i];
                    var status = 0;


                    if (parseFloat(sensorValue) < parseFloat(sensorMinimumValue)) status = 2;
                    if (parseFloat(sensorValue) > parseFloat(sensorMaximumValue)) status = 1;

                    //if (allSensorsShow && virtualRoomID == '0') {
                    tableConstruction += oneSensorRow(sensorType, sensorID, sensorLabel, sensorValue, sensorUnits, sensorTime, status);
                    //}
                }

            }


            //alert(tableConstruction);

            $("#sensorsTable").html(tableConstruction).listview("refresh");

        });



        function oneSensorRow(sensorType, sensorID, sensorLabel, sensorValue, sensorUnits, sensorTime, status) {

            var statusOK = ' ';
            var statusOver = ' Over! ';
            var statusProblem = ' problem! ';
            var statusUnder = ' Under! ';
            var statusValue = ' ';
            var sensorHighlightColor = '';
            if (sensorType == 'T') sensorHighlightColor = '<img src="img/star_red.png" class="ui-li-icon">';
            if (sensorType == 'H') sensorHighlightColor = '<img src="img/star_blue.png" class="ui-li-icon">';
            if (sensorType == 'D') sensorHighlightColor = '<img src="img/star_yellow.png" class="ui-li-icon">';
            if (sensorType == 'R') sensorHighlightColor = '<img src="img/star_black.png" class="ui-li-icon">';

            if (status == 0) statusValue = statusOK;
            if (status == 1) statusValue = statusOver;
            if (status == 2) statusValue = statusUnder;

            //var diff = Math.abs(new Date() - new Date(sensorTime));
            //var minutes = Math.floor((diff/1000)/60);
            //var minutesToDisplay = ' ' + minutes + ' min. ago' + ' ';


            //if (minutes > 9) statusValue = statusProblem;

            //if (minutes > 99) minutesToDisplay = ' ' + ' ages ago' + ' ';

            return '<li>'
                    + sensorHighlightColor
                    + sensorID  + ' - '  + sensorLabel

                    + '<span class="ui-li-count">' + sensorValue  + sensorUnits + statusValue   + '</span>'
                //+ minutesToDisplay
                    + '</li>';
        }


    });

}


function deviceReady() {

    handleSensors();
    appComfortZone();
    appGreenHouse();
    appCO2Free();

}
</script>
</body>
</html>
